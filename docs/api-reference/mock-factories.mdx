# モックファクトリー API

生成されるモックファクトリー関数のAPIリファレンスです。

## 基本的なファクトリー関数

### `create[Model]Mock`

単一のモックオブジェクトを生成します。

```typescript
function createUserMock(overrides?: Partial<User>): User
```

#### パラメータ

- `overrides` (optional): 生成されるデータの一部を上書きするオブジェクト

#### 戻り値

- 完全な型付けされたモデルオブジェクト

#### 使用例

```typescript
// デフォルト値で生成
const user = createUserMock();

// 一部のフィールドを上書き
const customUser = createUserMock({
  name: 'カスタム名前',
  email: 'custom@example.com'
});
```

### `create[Model]MockBatch`

複数のモックオブジェクトを一度に生成します。

```typescript
function createUserMockBatch(
  count: number,
  overrides?: Partial<User>
): User[]
```

#### パラメータ

- `count`: 生成するオブジェクトの数
- `overrides` (optional): すべての生成オブジェクトに適用される上書き値

#### 戻り値

- モックオブジェクトの配列

#### 使用例

```typescript
// 10個のユーザーを生成
const users = createUserMockBatch(10);

// すべて管理者として5人生成
const admins = createUserMockBatch(5, {
  role: 'ADMIN'
});
```

## リレーション付きファクトリー

`createRelationMocks`オプションが有効な場合、リレーションを含むファクトリーが生成されます。

### `create[Model]WithRelationsMock`

リレーションを含む完全なオブジェクトを生成します。

```typescript
function createUserWithRelationsMock(
  overrides?: DeepPartial<UserWithRelations>
): UserWithRelations
```

#### 使用例

```typescript
// ユーザーと関連する投稿を生成
const userWithPosts = createUserWithRelationsMock();
console.log(userWithPosts.posts); // Post[]

// リレーションをカスタマイズ
const user = createUserWithRelationsMock({
  posts: [
    { title: 'カスタム投稿1' },
    { title: 'カスタム投稿2' }
  ]
});
```

## 高度な使用方法

### ファクトリーのカスタマイズ

生成されたファクトリーをラップして、プロジェクト固有のロジックを追加できます：

```typescript
import { createUserMock as baseCreateUserMock } from './generated';

export function createUserMock(overrides = {}) {
  const user = baseCreateUserMock(overrides);
  
  // カスタムロジック
  if (user.role === 'ADMIN') {
    user.permissions = ['read', 'write', 'delete'];
  }
  
  return user;
}
```

### 条件付き生成

```typescript
function createConditionalUser(isAdmin: boolean) {
  return createUserMock({
    role: isAdmin ? 'ADMIN' : 'USER',
    permissions: isAdmin ? ['all'] : ['read']
  });
}
```

### 連番ID生成

```typescript
let userIdCounter = 1;

function createSequentialUsers(count: number) {
  return Array.from({ length: count }, () =>
    createUserMock({
      id: `user-${userIdCounter++}`,
      email: `user${userIdCounter}@example.com`
    })
  );
}
```

## 型定義

生成されるファクトリー関数の型定義：

```typescript
// 基本的なファクトリー
type MockFactory<T> = (overrides?: Partial<T>) => T;

// バッチファクトリー
type BatchMockFactory<T> = (
  count: number,
  overrides?: Partial<T>
) => T[];

// リレーション付きファクトリー
type RelationMockFactory<T> = (
  overrides?: DeepPartial<T>
) => T;
```

## エラーハンドリング

ファクトリー関数は以下の場合にエラーをスローする可能性があります：

1. **無効な上書き値**: 型に合わない値を渡した場合
2. **必須フィールドの欠落**: 必須フィールドを`null`や`undefined`で上書きした場合

```typescript
try {
  // これはエラーになる可能性がある
  const user = createUserMock({
    email: null // emailは必須フィールド
  });
} catch (error) {
  console.error('モック生成エラー:', error);
}
```